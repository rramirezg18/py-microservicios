<div class="matches-page">
  <header class="hero">
    <div class="wrap">
      <nav class="crumbs">
        <a class="pill ghost" routerLink="/admin">Volver</a>
        <span class="sep">/</span>
        <span class="muted">Partidos</span>
      </nav>
      <h1>Gestión de Partidos</h1>
      <p class="sub">Programa encuentros, consulta el estado y salta directo al panel o marcador.</p>
    </div>
  </header>

  <main class="content">
    <section class="card form-card">
      <h2>Programar nuevo partido</h2>
      <form [formGroup]="form" (ngSubmit)="submit()" class="form-grid">
        <label>
          <span>Local</span>
          <select formControlName="homeTeamId" [disabled]="loadingTeams()">
            <option [ngValue]="null" disabled>Selecciona equipo</option>
            <option *ngFor="let team of teams(); trackBy: trackByTeamId" [ngValue]="team.id">{{ team.name }}</option>
          </select>
        </label>

        <label>
          <span>Visitante</span>
          <select formControlName="awayTeamId" [disabled]="loadingTeams()">
            <option [ngValue]="null" disabled>Selecciona equipo</option>
            <option *ngFor="let team of teams(); trackBy: trackByTeamId" [ngValue]="team.id">{{ team.name }}</option>
          </select>
        </label>

        <label>
          <span>Fecha y hora (local)</span>
          <input type="datetime-local" formControlName="date" />
        </label>

        <label>
          <span>Duración del período (seg)</span>
          <input type="number" min="60" step="30" formControlName="quarterDurationSeconds" />
        </label>

        <div class="actions">
          <button class="pill" type="submit" [disabled]="disableSubmit()">Programar</button>
          <button class="pill ghost" type="button" (click)="refresh()" [disabled]="loadingMatches()">Actualizar lista</button>
        </div>
      </form>

      <div *ngIf="success()" class="alert success">{{ success() }}</div>
      <div *ngIf="error()" class="alert warn">{{ error() }}</div>
    </section>

    <section class="card list-card">
      <div class="list-head">
        <h2>Partidos recientes</h2>
        <span *ngIf="loadingMatches()" class="muted">Cargando...</span>
      </div>

      <ul class="matches-list">
        <li *ngFor="let match of matches(); trackBy: trackByMatchId" class="match-item">
          <div class="info">
            <div class="teams">{{ match.home.name }} <span class="vs">vs</span> {{ match.away.name }}</div>
            <div class="meta">
              <span class="badge" [class.live]="match.status === 'Live'" [class.done]="match.status === 'Finished'">
                {{ match.status }}
              </span>
              <span class="dot"></span>
              <span>{{ match.dateMatchUtc | date: 'medium' }}</span>
              <span class="dot"></span>
              <span>Marcador {{ match.homeScore }} - {{ match.awayScore }}</span>
            </div>
          </div>

          <div class="item-actions">
            <button class="pill ghost" type="button" (click)="goToScoreboard(match.id)">Marcador</button>
            <button class="pill" type="button" (click)="goToControl(match.id)">Panel</button>
          </div>
        </li>
      </ul>

      <div *ngIf="!loadingMatches() && matches().length === 0" class="empty">No hay partidos programados aún.</div>
    </section>
  </main>
</div>
