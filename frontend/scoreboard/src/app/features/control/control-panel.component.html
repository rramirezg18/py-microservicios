<div class="control-panel-page">
  <section class="cp-hero">
    <div class="wrap">
      <div class="crumbs">
        <button class="pill ghost" type="button" (click)="goBack()">Volver</button>
        <span class="sep">/</span>
        <span class="muted">Panel de Control</span>
      </div>

      <h1>Control del Partido</h1>
      <p class="sub">Gestiona el reloj, puntos, faltas y período en vivo.</p>

      <div class="hero-actions">
        <button class="pill" type="button" (click)="goScoreboard()">Ver marcador en vivo</button>
        <button class="pill" type="button" (click)="chooseMatch()">Elegir partido</button>
        <button class="pill warn" type="button" (click)="logout()">Cerrar sesión</button>
      </div>
    </div>
  </section>

  <div class="cp-container">
    <div *ngIf="loading()" class="alert">Cargando partido...</div>
    <div *ngIf="!loading() && error()" class="alert warn">{{ error() }}</div>
    <section class="card head-card">
      <div class="head-left">
        <div class="teams-line">
          <span class="team home">{{ home().name }}</span>
          <span class="vs">vs</span>
          <span class="team away">{{ away().name }}</span>
        </div>

        <div class="meta-line">
          <span class="badge" [class.err]="!timerRunning()">{{ timerRunning() ? 'Running' : 'Paused' }}</span>
          <span class="dot"></span>
          <span class="muted">Período</span>
          <span class="period">{{ quarter() }}</span>
          <span class="dot"></span>
          <span class="muted">Estado</span>
          <span class="status">{{ status() }}</span>
        </div>
      </div>

      <div class="head-right">
        <div class="clock">{{ formattedTimer() }}</div>
        <div class="clock-sub">{{ clockLabel() }}</div>
      </div>
    </section>

    <section class="card actions">
      <button
        class="btn go"
        type="button"
        (click)="startPeriod()"
        [disabled]="loading() || timerRunning() || isTimeout() || gameOver()"
      >
        Start
      </button>

      <button
        class="btn"
        type="button"
        (click)="resumeTimer()"
        [disabled]="loading() || timerRunning() || timerSeconds() <= 0 || isTimeout()"
      >
        Resume
      </button>

      <button class="btn stop" type="button" (click)="stopTimer()" [disabled]="loading()">Stop</button>

      <button
        class="btn"
        type="button"
        (click)="startTimeout(30)"
        [disabled]="loading() || isTimeout() || !timerRunning()"
      >
        Timeout (0:30)
      </button>

      <button
        class="btn"
        type="button"
        (click)="startTimeout(60)"
        [disabled]="loading() || isTimeout() || !timerRunning()"
      >
        Timeout (1:00)
      </button>

      <button class="btn ghost" type="button" (click)="resetTimer()" [disabled]="loading()">Reset</button>
    </section>

    <section class="grid-2">
      <div class="card">
        <div class="card-title">Posesión</div>
        <div class="pos">
          <button
            class="btn pos-btn"
            type="button"
            [class.active]="possession() === 'home'"
            (click)="setPossession('home')"
          >
            Local
          </button>
          <button class="btn pos-none" type="button" (click)="setPossession('none')">
            {{
              possession() === 'none'
                ? 'None'
                : possession() === 'home'
                ? home().name
                : away().name
            }}
          </button>
          <button
            class="btn pos-btn"
            type="button"
            [class.active]="possession() === 'away'"
            (click)="setPossession('away')"
          >
            Visitante
          </button>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Período</div>
        <div class="period">
          <button class="btn minus" type="button" (click)="changeQuarter(-1)" [disabled]="loading()">-1</button>
          <div class="period-box">
            <span class="num">{{ quarter() }}</span>
          </div>
          <button class="btn plus" type="button" (click)="changeQuarter(1)" [disabled]="loading()">+1</button>
        </div>
      </div>
    </section>

    <section class="grid-2">
      <div class="card team">
        <div class="name">{{ home().name }}</div>
        <div class="sub">SCORE</div>

        <div class="score-row">
          <button class="btn neg" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('home', -1)">
            -1
          </button>
          <div class="score-display">{{ home().score }}</div>
          <button class="btn pos" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('home', 1)">
            +1
          </button>
        </div>
        <div class="score-actions">
          <button class="btn pos" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('home', 3)">
            +3
          </button>
          <button class="btn pos" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('home', 2)">
            +2
          </button>
        </div>

        <div class="sub fouls-title">FOULS</div>
        <div class="fouls-row">
          <button class="btn neg" type="button" (click)="adjustFouls('home', -1)" [disabled]="loading()">-1</button>
          <div class="fouls-display">{{ home().fouls }}</div>
          <button class="btn pos" type="button" (click)="adjustFouls('home', 1)" [disabled]="loading()">+1</button>
        </div>
      </div>

      <div class="card team">
        <div class="name">{{ away().name }}</div>
        <div class="sub">SCORE</div>

        <div class="score-row">
          <button class="btn neg" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('away', -1)">
            -1
          </button>
          <div class="score-display">{{ away().score }}</div>
          <button class="btn pos" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('away', 1)">
            +1
          </button>
        </div>
        <div class="score-actions">
          <button class="btn pos" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('away', 3)">
            +3
          </button>
          <button class="btn pos" type="button" [disabled]="loading() || !canScore()" (click)="adjustScore('away', 2)">
            +2
          </button>
        </div>

        <div class="sub fouls-title">FOULS</div>
        <div class="fouls-row">
          <button class="btn neg" type="button" (click)="adjustFouls('away', -1)" [disabled]="loading()">-1</button>
          <div class="fouls-display">{{ away().fouls }}</div>
          <button class="btn pos" type="button" (click)="adjustFouls('away', 1)" [disabled]="loading()">+1</button>
        </div>
      </div>
    </section>

    <section class="card tools">
      <div class="group">
        <div class="title">Navegación</div>
        <button class="pill" type="button" (click)="goBack()">Volver</button>
        <button class="pill" type="button" (click)="goScoreboard()">Ver marcador en vivo</button>
        <button class="pill" type="button" (click)="chooseMatch()">Elegir partido</button>
      </div>

      <div class="group">
        <div class="title">Administración</div>
        <button class="pill" type="button" (click)="goAdmin()">Registrar equipo</button>
      </div>
    </section>
  </div>
</div>
